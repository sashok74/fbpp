# –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ fbpp (Firebird C++20 Wrapper)

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-10-01
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 1.0.0
**–ê–≤—Ç–æ—Ä –∞–Ω–∞–ª–∏–∑–∞:** Claude Code

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ](#–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ-—Ä–µ–∑—é–º–µ)
2. [–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π-–∞–Ω–∞–ª–∏–∑)
4. [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Firebird API](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-firebird-api)
5. [–°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã](#—Å–∏—Å—Ç–µ–º–∞-—Ç–∏–ø–æ–≤-–∏-–∞–¥–∞–ø—Ç–µ—Ä—ã)
6. [–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞](#–∫–∞—á–µ—Å—Ç–≤–æ-–∫–æ–¥–∞)
7. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
8. [–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–∏—Å–∫–∏](#–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–∏—Å–∫–∏)
9. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-—É–ª—É—á—à–µ–Ω–∏—é)
10. [–í–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è](#–≤–æ–∑–º–æ–∂–Ω—ã–µ-–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è)
11. [–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π](#–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–ø–ª–∞–Ω-–¥–µ–π—Å—Ç–≤–∏–π)

---

## –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4/5)

**fbpp** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é, –ø—Ä–æ–¥—É–º–∞–Ω–Ω—É—é –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –±–æ–≥–∞—Ç—É—é** –±–∏–±–ª–∏–æ—Ç–µ–∫—É-–æ–±–µ—Ä—Ç–∫—É –Ω–∞–¥ Firebird OO API. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∫ C++20, —Ç–∞–∫ –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å Firebird, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —á–∞—Å—Ç–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

### –ö–ª—é—á–µ–≤—ã–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. ‚úÖ **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ Firebird 5** - INT128, DECFLOAT(16/34), NUMERIC(38,x), TIMESTAMP WITH TIME ZONE
2. ‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π C++20 –∫–æ–¥** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤, SFINAE, fold expressions, concepts (—á–∞—Å—Ç–∏—á–Ω–æ)
3. ‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö** - JSON, tuples, strongly-typed objects
4. ‚úÖ **Statement caching** - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
5. ‚úÖ **Named parameters** - —É–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
6. ‚úÖ **RAII –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ Firebird
7. ‚úÖ **–•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - CLAUDE.md, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ doc/

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. ‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - Connection –Ω–µ thread-safe (documented assumption)
2. ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ connection pooling** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production server applications
3. ‚ö†Ô∏è **–ù–µ–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ BLOB** - —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
4. ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ async API** - –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö async –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
5. ‚ö†Ô∏è **Singleton –¥–ª—è Environment** - –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|----------|-------------|
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (LOC) | 21,286 | –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è library |
| –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã | 35 | –•–æ—Ä–æ—à–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (.cpp) | 14 | –ú–Ω–æ–≥–æ header-only –∫–æ–¥–∞ |
| –¢–µ—Å—Ç—ã | 14 test files | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| –ü—Ä–∏–º–µ—Ä—ã | 10 examples | –•–æ—Ä–æ—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 9 MD files | –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | 6 (external) | –£–ø—Ä–∞–≤–ª—è–µ–º–æ —á–µ—Ä–µ–∑ Conan |

---

## –û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç **–æ—Ç–ª–∏—á–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é**:

```
fbpp/
‚îú‚îÄ‚îÄ include/fbpp/          # Public API (25 headers)
‚îÇ   ‚îú‚îÄ‚îÄ core/             # Core wrappers (Connection, Statement, Transaction, etc)
‚îÇ   ‚îú‚îÄ‚îÄ adapters/         # Type adapters (TTMath, CppDecimal, chrono)
‚îÇ   ‚îú‚îÄ‚îÄ fbpp.hpp          # Main convenience header
‚îÇ   ‚îú‚îÄ‚îÄ fbpp_extended.hpp # Extended types
‚îÇ   ‚îî‚îÄ‚îÄ fbpp_all.hpp      # All features
‚îú‚îÄ‚îÄ src/                   # Implementation (14 files)
‚îÇ   ‚îú‚îÄ‚îÄ core/firebird/    # Firebird API wrappers
‚îÇ   ‚îî‚îÄ‚îÄ util/             # Utilities (logging, config)
‚îú‚îÄ‚îÄ tests/                 # Unit tests (15 files)
‚îÇ   ‚îú‚îÄ‚îÄ unit/             # Core tests
‚îÇ   ‚îî‚îÄ‚îÄ adapters/         # Adapter tests
‚îú‚îÄ‚îÄ examples/              # Usage examples (10 files)
‚îú‚îÄ‚îÄ doc/                   # Documentation (9 MD files)
‚îú‚îÄ‚îÄ third_party/           # Vendored dependencies
‚îÇ   ‚îú‚îÄ‚îÄ ttmath/           # Big integer library
‚îÇ   ‚îî‚îÄ‚îÄ cppdecimal/       # IEEE decimal library
‚îú‚îÄ‚îÄ cmake/                 # CMake modules
‚îî‚îÄ‚îÄ config/                # Configuration files
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ public/private API
- ‚úÖ –õ–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ Vendor-free dependencies –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ—Ç –ø–∞–ø–∫–∏ `benchmarks/` –¥–ª—è performance testing
- ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `.clang-format` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**–£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —á–µ—Ä–µ–∑ Conan:**
```
gtest/1.14.0          # Unit testing
spdlog/1.12.0         # Logging
nlohmann_json/3.11.3  # JSON processing
```

**Vendored (included):**
```
ttmath                # 128-bit integers
cppdecimal            # IEEE 754-2008 decimal arithmetic
```

**System:**
```
Firebird 5.x client   # libfbclient.so / fbclient_ms.lib
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã
- ‚úÖ Vendored –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ numeric libraries (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è reproducibility)
- ‚ö†Ô∏è TTMath –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è —Å 2014 –≥–æ–¥–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π)
- ‚ö†Ô∏è CppDecimal - –Ω–µ —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (—Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Intel Decimal Library)

### Build System (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**CMake —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ - –æ—Ç–ª–∏—á–Ω–∞:**

```cmake
# –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π CMake 3.20+
- Proper target_link_libraries with INTERFACE/PUBLIC/PRIVATE
- Install rules —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ export targets
- CMakePackageConfigHelpers –¥–ª—è fbppConfig.cmake
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ BUILD_TESTING –∏ BUILD_EXAMPLES
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –°–ª–µ–¥—É–µ—Ç modern CMake best practices
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ find_package(fbpp) –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ INTERFACE libraries –¥–ª—è header-only
- ‚úÖ Cross-platform paths –∏ detection

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- üí° –î–æ–±–∞–≤–∏—Ç—å CPack –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è installers (.deb, .rpm, .msi)
- üí° –î–æ–±–∞–≤–∏—Ç—å option –¥–ª—è building shared library
- üí° Version stamping –≤ headers (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **layered architecture** —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         User Application Code               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Public API Layer (include/fbpp/core/)      ‚îÇ
‚îÇ  - Connection, Transaction, Statement       ‚îÇ
‚îÇ  - ResultSet, Batch                         ‚îÇ
‚îÇ  - Extended Types (Int128, DecFloat, etc)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Type Adapters Layer (adapters/)            ‚îÇ
‚îÇ  - TypeAdapter<T> traits                    ‚îÇ
‚îÇ  - TTMath adapter, CppDecimal adapter       ‚îÇ
‚îÇ  - std::chrono adapter                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Packer/Unpacker Layer (core/)              ‚îÇ
‚îÇ  - JSON packer/unpacker                     ‚îÇ
‚îÇ  - Tuple packer/unpacker                    ‚îÇ
‚îÇ  - Message buffer management                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Firebird Wrapper Layer (src/core/firebird/)‚îÇ
‚îÇ  - fb_connection, fb_statement, fb_transaction‚îÇ
‚îÇ  - fb_message_metadata, fb_result_set       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Firebird OO API (libfbclient)              ‚îÇ
‚îÇ  - IAttachment, ITransaction, IStatement    ‚îÇ
‚îÇ  - IResultSet, IMessageMetadata             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤** - –∫–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç –µ–¥–∏–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- ‚úÖ **Dependency inversion** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π, –Ω–µ –æ—Ç –¥–µ—Ç–∞–ª–µ–π
- ‚úÖ **Extensibility** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã —Ç–∏–ø–æ–≤
- ‚úÖ **Template-heavy design** - –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∫–æ–¥–∞ compile-time

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **Tight coupling —Å Firebird API** - —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Firebird
- ‚ö†Ô∏è **Environment singleton** - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç testing –∏ multi-instance scenarios
- ‚ö†Ô∏è **No abstraction layer** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –ë–î (–Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å intentional)

### Design Patterns (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:

#### 1. **RAII (Resource Acquisition Is Initialization)** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```cpp
class Connection {
public:
    ~Connection() {
        disconnect();
        statusWrapper_.dispose();
    }
};
```
**–û—Ü–µ–Ω–∫–∞:** –û—Ç–ª–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤–µ–∑–¥–µ

#### 2. **Singleton (Environment)** ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ
```cpp
class Environment {
public:
    static Environment& getInstance() {
        static Environment instance;
        return instance;
    }
};
```
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç unit testing
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ instances –¥–ª—è —Ä–∞–∑–Ω—ã—Ö Firebird installations
- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Dependency Injection

#### 3. **Strategy Pattern (TypeAdapter)** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```cpp
template<typename T>
struct TypeAdapter {
    static constexpr bool is_specialized = false;
};

template<>
struct TypeAdapter<ttmath::Int<2>> {
    static constexpr bool is_specialized = true;
    // ...
};
```
**–û—Ü–µ–Ω–∫–∞:** –û—Ç–ª–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è

#### 4. **Factory Pattern (Statement Cache)** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
```cpp
class StatementCache {
    std::shared_ptr<Statement> get(Connection* conn, const std::string& sql, unsigned flags);
};
```
**–û—Ü–µ–Ω–∫–∞:** –•–æ—Ä–æ—à–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–æ –º–æ–≥–ª–∞ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å abstract factory –¥–ª—è testability

#### 5. **Template Method (pack/unpack)** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```cpp
template<typename T>
T unpack(const uint8_t* buffer, MessageMetadata* meta, Transaction* txn) {
    if constexpr (is_tuple_v<T>) {
        return unpack_tuple<T>(buffer, meta, txn);
    } else if constexpr (is_json_v<T>) {
        return unpack_json(buffer, meta, txn);
    }
    // ...
}
```
**–û—Ü–µ–Ω–∫–∞:** –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ C++17/20 features

#### 6. **Adapter Pattern (Firebird wrappers)** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
–û–±–µ—Ä—Ç–∫–∏ –Ω–∞–¥ Firebird API (Connection ‚Üí IAttachment, Statement ‚Üí IStatement)
**–û—Ü–µ–Ω–∫–∞:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**Smart pointers usage:**
- 102 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è smart pointers –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `unique_ptr` –¥–ª—è ownership
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `shared_ptr` –¥–ª—è shared ownership
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `weak_ptr` –≤ ResultSet –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è circular references

```cpp
// –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ ResultSet
class ResultSet {
    std::weak_ptr<Transaction> transaction_;  // –ù–µ –≤–ª–∞–¥–µ–µ—Ç, –∏–∑–±–µ–≥–∞–µ—Ç —Ü–∏–∫–ª–æ–≤
};
```

**RAII –≤–µ–∑–¥–µ:**
```cpp
// Connection
~Connection() {
    disconnect();
    statusWrapper_.dispose();
}

// Statement
~Statement() {
    cleanup();
}

// Transaction - auto-rollback
~Transaction() {
    if (active_) {
        try {
            Rollback();
        } catch(...) {}
    }
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **Raw pointers –¥–ª—è Connection* –≤ Statement** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π dangling pointer
  - –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω–æ —á–µ—Ä–µ–∑ `std::weak_ptr<Connection>` –∏–ª–∏ lifetime guarantee documentation

### Thread Safety (‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- 8 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π thread primitives (—Ç–æ–ª—å–∫–æ –≤ StatementCache)
- **Connection –Ω–µ thread-safe** (–∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ: "one connection per thread")
- **Transaction –Ω–µ thread-safe**
- **StatementCache** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π thread-safe –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (mutex-protected)

```cpp
class StatementCache {
    std::mutex mutex_;
    std::lock_guard<std::mutex> lock(mutex_);  // –ü—Ä–∞–≤–∏–ª—å–Ω–æ
};
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç connection pool** –¥–ª—è thread-safe multi-threaded access
- ‚ö†Ô∏è **Environment singleton** –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –Ω–µ thread-safe –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ö–æ—Ç—è Meyers singleton is)
- ‚ö†Ô∏è **–ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** –æ thread safety –≥–∞—Ä–∞–Ω—Ç–∏—è—Ö –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å ConnectionPool —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
2. –î–æ–±–∞–≤–∏—Ç—å thread safety annotations –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É
3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å read-write locks –¥–ª—è –∫—ç—à–∞

### Error Handling (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** Exception-based (237 uses of try/catch/throw)

```cpp
try {
    auto& st = status();
    attachment_ = env_.getProvider()->attachDatabase(...);
} catch (const Firebird::FbException& e) {
    throw FirebirdException(e);  // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
}
```

**FirebirdException:**
```cpp
class FirebirdException : public std::runtime_error {
    std::string what_;
    int errorCode_;
    std::string sqlState_;
};
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –í—Å–µ Firebird exceptions –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ fbpp::core::FirebirdException
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è error code –∏ SQL state
- ‚úÖ RAII –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç cleanup –¥–∞–∂–µ –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç error codes enum** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å Firebird error codes
- ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ std::expected<T, Error>** –¥–ª—è non-exceptional errors (C++23)
- ‚ö†Ô∏è **–ù–µ—Ç retry –º–µ—Ö–∞–Ω–∏–∑–º–∞** –¥–ª—è transient errors (network issues)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å `enum class ErrorCode` —Å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ Firebird –æ—à–∏–±–∫–∞–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å `isRetryable()` method –∫ FirebirdException
3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å `std::expected` –¥–ª—è C++23 compatibility

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Firebird API

### API Coverage (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:**

| Firebird Interface | fbpp Wrapper | Coverage | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-------------------|--------------|----------|-------------|
| IAttachment | Connection | 90% | –û—Ç–ª–∏—á–Ω–æ |
| ITransaction | Transaction | 95% | –û—Ç–ª–∏—á–Ω–æ |
| IStatement | Statement | 90% | –û—Ç–ª–∏—á–Ω–æ |
| IResultSet | ResultSet | 85% | –•–æ—Ä–æ—à–æ |
| IBatch | Batch | 70% | –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ |
| IMessageMetadata | MessageMetadata | 95% | –û—Ç–ª–∏—á–Ω–æ |
| IBlob | Partial | 30% | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ |
| IEvents | ‚ùå | 0% | ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| IService | ‚ùå | 0% | ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| IReplicator | ‚ùå | 0% | ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:**
- Connection management (attach, detach, create DB, drop DB)
- Transaction management (commit, rollback, retaining variants)
- Statement execution (execute, executeQuery)
- Parameterized queries (positional and named)
- Cursor operations (fetch, fetchAll)
- Batch operations (basic)
- Metadata inspection
- Cancel operations
- Extended types (INT128, DECFLOAT, NUMERIC(38,x), TIMESTAMP WITH TZ)

‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:**
- BLOB operations (—Ç–æ–ª—å–∫–æ loadBlob/createBlob, –Ω–µ—Ç streaming)
- Batch operations (–Ω–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ batch parameters)

‚ùå **–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:**
- Events (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –ë–î)
- Services API (backup/restore, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, user management)
- Replication API
- Arrays (Firebird ARRAY type)
- Savepoints (–≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
- Two-phase commit
- Connection pooling

### Extended Types Support (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**–≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Å–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞!**

#### INT128 Support

**Core implementation:**
```cpp
class Int128 {
    std::array<uint8_t, 16> data_;  // Little-endian
};
```

**TTMath adapter:**
```cpp
template<>
struct TypeAdapter<ttmath::Int<2>> {
    static firebird_type to_firebird(const user_type& value) {
        firebird_type result{};
        std::memcpy(result.data(), value.table, 16);
        return result;
    }
};
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –û—Ç–ª–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ core —Ç–∏–ø–æ–≤, —Ç–∞–∫ –∏ TTMath

#### DECFLOAT(16/34) Support

**Core implementation:**
```cpp
class DecFloat16 {
    std::array<uint8_t, 8> data_;
    explicit DecFloat16(const std::string& str);  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç IDecFloat16
    std::string to_string() const;
};
```

**CppDecimal adapter:**
```cpp
template<>
struct TypeAdapter<dec::DecQuad> {  // DECFLOAT(34)
    // Conversion —á–µ—Ä–µ–∑ IBM decNumber
};
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Firebird IDecFloat16/IDecFloat34

#### NUMERIC(38,x) - Scaled Integers

**TTMath implementation:**
```cpp
template<std::size_t Words, int Scale>
class TTNumeric {
    ttmath::Int<Words> value_;
    static constexpr int scale_ = Scale;

    // String conversion —Å —É—á–µ—Ç–æ–º scale
    std::string to_string() const {
        auto str = value_.ToString();
        // –í—Å—Ç–∞–≤–∏—Ç—å decimal point –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
    }
};
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ –•–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å TODO –¥–ª—è overflow checking

#### TIMESTAMP WITH TIME ZONE

```cpp
class TimestampTz {
    uint32_t date_;       // ISC_DATE
    uint32_t time_;       // ISC_TIME
    uint16_t zone_id_;    // IANA timezone ID
    int16_t offset_;      // Offset from UTC in minutes
};
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –Ω–µ—Ç –ø–æ–ª–Ω–æ–π timezone manipulation

### Type Detection Logic (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∫–æ–¥ –∏–∑ FIREBIRD_TYPES_HANDLING.md:**

```cpp
case FieldType::Numeric:
    // 1. Check DECFLOAT types first (by wire_type)
    if (wire_type == SQL_DECFLOAT16) ‚Üí use pack_decfloat16()
    if (wire_type == SQL_DECFLOAT34) ‚Üí use pack_decfloat34()

    // 2. Check NUMERIC/DECIMAL with scale
    if (scale != 0) {
        if (precision > 18 || length == 16) ‚Üí use pack_scaled_int128()
        else ‚Üí use pack_scaled_int64()
    }

    // 3. Pure INT128 (no scale)
    if (wire_type == SQL_INT128 && scale == 0) ‚Üí use pack_int128()
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫, —Ö–æ—Ä–æ—à–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω

### Message Buffer Management (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**MessageMetadata wrapper:**
```cpp
class MessageMetadata {
    Firebird::IMessageMetadata* metadata_;

    unsigned getCount() const;
    FieldInfo getField(unsigned index) const;
    unsigned getMessageLength() const;

    struct FieldInfo {
        unsigned index;
        std::string name;
        unsigned type;          // SQL_* constants
        unsigned subType;
        unsigned length;
        int scale;
        unsigned offset;
        unsigned nullOffset;
        // ...
    };
};
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent abstraction over Firebird metadata

### Status Management (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**Pattern –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤–µ–∑–¥–µ:**
```cpp
class Connection {
    Firebird::IStatus* status_;                    // Owned
    mutable Firebird::ThrowStatusWrapper statusWrapper_{nullptr};

    Firebird::ThrowStatusWrapper& status() const {
        statusWrapper_.init();
        return statusWrapper_;
    }
};
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ö–∞–∂–¥—ã–π Connection/Statement/Transaction –∏–º–µ–µ—Ç —Å–≤–æ–π IStatus - –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- ‚ö†Ô∏è –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ status management

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å thread-local status pool –¥–ª—è reduction allocation

---

## –°–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤ –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã

### Type Adapter System (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```cpp
// Base template - SFINAE friendly
template<typename T>
struct TypeAdapter {
    static constexpr bool is_specialized = false;
};

// Specialization example
template<>
struct TypeAdapter<ttmath::Int<2>> {
    static constexpr bool is_specialized = true;
    using firebird_type = std::array<uint8_t, 16>;
    using user_type = ttmath::Int<2>;

    static firebird_type to_firebird(const user_type& value);
    static user_type from_firebird(const firebird_type& value);
};
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ **Compile-time detection** - `is_specialized` flag
- ‚úÖ **Type safety** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ-–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∏–ø
- ‚úÖ **Bidirectional conversion** - to/from Firebird
- ‚úÖ **Optional support** - `std::optional<T>` handled automatically
- ‚úÖ **Extensibility** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –∞–¥–∞–ø—Ç–µ—Ä—ã

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```cpp
// User code
using MyInt128 = ttmath::Int<2>;
MyInt128 big_value = /* ... */;

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TypeAdapter<ttmath::Int<2>>
stmt.execute(txn, std::make_tuple(big_value));
```

### Pack/Unpack System (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**Universal pack function:**
```cpp
template<typename T>
void pack(const T& value, uint8_t* buffer, MessageMetadata* meta, Transaction* txn) {
    if constexpr (is_tuple_v<T>) {
        pack_tuple(value, buffer, meta, txn);
    } else if constexpr (is_json_v<T>) {
        pack_json(value, buffer, meta, txn);
    } else if constexpr (TypeAdapter<T>::is_specialized) {
        // Use adapter
    } else {
        static_assert(always_false<T>::value, "Unsupported type");
    }
}
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ C++17 `if constexpr`

### JSON Integration (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**–î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:**

```cpp
// JSON ‚Üí Firebird
nlohmann::json params = {
    {"id", 123},
    {"name", "Alice"},
    {"salary", 50000.50}
};
stmt.execute(txn, params);

// Firebird ‚Üí JSON
auto rs = stmt.executeQuery(txn);
while (auto row = rs.fetchOneJSON()) {
    std::cout << row.dump(2) << std::endl;
}
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ JSON —Ç–∏–ø—ã:**
```
JSON ‚Üí Firebird
- null ‚Üí NULL
- number ‚Üí INTEGER/BIGINT/DOUBLE/NUMERIC
- string ‚Üí VARCHAR/CHAR/DATE/TIME/TIMESTAMP
- boolean ‚Üí –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (‚ö†Ô∏è)
- array ‚Üí –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (‚ö†Ô∏è)
- object ‚Üí –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (‚ö†Ô∏è)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ JSON arrays** –¥–ª—è batch operations
- ‚ö†Ô∏è **–ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ nested JSON** –¥–ª—è BLOB/TEXT –ø–æ–ª–µ–π

### Tuple Integration (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**Type-safe tuple packing:**
```cpp
// Compile-time type checking
auto result = stmt.executeQuery(txn).fetchOne<int, std::string, double>();

// Insert with tuple
stmt.execute(txn, std::make_tuple(123, "Alice", 50000.50));
```

**Fold expressions –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏:**
```cpp
template<typename Tuple, size_t... Is>
Tuple unpack_tuple_impl(const uint8_t* buffer, MessageMetadata* meta,
                        Transaction* txn, std::index_sequence<Is...>) {
    return std::make_tuple(
        unpack_field<std::tuple_element_t<Is, Tuple>>(buffer, meta, Is, txn)...
    );
}
```

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –û—Ç–ª–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ fold expressions

### Chrono Adapter (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

```cpp
// std::chrono::system_clock::time_point ‚Üí TIMESTAMP
auto now = std::chrono::system_clock::now();
stmt.execute(txn, std::make_tuple(now));

// TIMESTAMP ‚Üí std::chrono::system_clock::time_point
auto tp = rs.fetchOne<std::chrono::system_clock::time_point>();
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ C++20 chrono calendar types** (year_month_day, etc)
- ‚ö†Ô∏è **Timezone support –æ–≥—Ä–∞–Ω–∏—á–µ–Ω** - –Ω–µ—Ç –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å std::chrono::zoned_time

---

## –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### Code Metrics

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ |
|---------|----------|--------|
| Total LOC | 21,286 | ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| Header LOC | 3,919 | ‚úÖ –•–æ—Ä–æ—à–æ |
| Source LOC | 2,744 | ‚úÖ –•–æ—Ä–æ—à–æ |
| Comments | 1,611 | ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ –•–æ—Ä–æ—à–æ |
| Blank lines | 1,672 | ‚úÖ –ß–∏—Ç–∞–µ–º–æ |
| Average file size | ~435 LOC | ‚úÖ –£–ø—Ä–∞–≤–ª—è–µ–º–æ |
| Largest file | fb_statement_cache.cpp (446 LOC) | ‚úÖ OK |

### Code Style (‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ)

**–°–æ–±–ª—é–¥–∞–µ—Ç—Å—è:**
- ‚úÖ Consistent naming (snake_case –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, PascalCase –¥–ª—è –∫–ª–∞—Å—Å–æ–≤)
- ‚úÖ Namespace usage (fbpp::core, fbpp::adapters)
- ‚úÖ Header guards (#pragma once –≤–µ–∑–¥–µ)
- ‚úÖ Include ordering (system ‚Üí third-party ‚Üí local)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç .clang-format** - inconsistent formatting –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–∞–π–ª–∞—Ö
- ‚ö†Ô∏è **Mixed indentation** - –º–µ—Å—Ç–∞–º–∏ tabs, –º–µ—Å—Ç–∞–º–∏ spaces
- ‚ö†Ô∏è **Long lines** - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç—Ä–æ–∫–∏ > 120 chars

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å .clang-format –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Documentation (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**–û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è!**

**–§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
```
doc/
‚îú‚îÄ‚îÄ FIREBIRD_TYPES_HANDLING.md         # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç!
‚îú‚îÄ‚îÄ firebird_oo_api_doc.md             # Firebird API reference (121KB)
‚îú‚îÄ‚îÄ FIREBIRD_BUFFER_AND_TYPES.md       # Buffer layouts
‚îú‚îÄ‚îÄ EXTENDED_TYPES_ADAPTERS.md         # Type adapter architecture (29KB)
‚îú‚îÄ‚îÄ NAMED_PARAMETERS.md                # Named parameters implementation
‚îú‚îÄ‚îÄ PREPARED_STATEMENT_CACHE_SPEC.md   # Caching specification
‚îú‚îÄ‚îÄ TUPLE_PACKER_ARCHITECTURE.md       # Tuple packer design
‚îú‚îÄ‚îÄ LIB_V1_ARCHITECTURE.md             # Architecture overview
‚îî‚îÄ‚îÄ firebird_types_guide.md            # Type system guide
```

**CLAUDE.md:**
- –û—Ç–ª–∏—á–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è Claude Code
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- Type mapping table
- Common pitfalls
- Include path conventions

**Code comments:**
- Doxygen-style comments –≤ headers
- Inline comments –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
- TODO/FIXME –º–∞—Ä–∫–µ—Ä—ã (7 –Ω–∞–π–¥–µ–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç generated API docs** (doxygen –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- ‚ö†Ô∏è **README.md –ø–æ—á—Ç–∏ –ø—É—Å—Ç–æ–π** (—Ç–æ–ª—å–∫–æ 1 —Å—Ç—Ä–æ–∫–∞!)

### TODOs –∏ Technical Debt (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**–ù–∞–π–¥–µ–Ω–æ 7 TODO/FIXME:**

1. `ttmath_numeric.hpp:428` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ precision
2. `json_packer.hpp:192` - warning –æ truncation –¥–ª—è VARCHAR
3. `tuple_unpacker.hpp:76` - NUMERIC(38,x) scale interpretation
4. `json_unpacker.hpp:214` - BLOB base64 encoding
5. `tuple_packer.hpp:175` - NUMERIC(38,x) formatting —á–µ—Ä–µ–∑ IUtil
6. `DecPacked.hh:109` - TODO –≤ third-party (–º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å)
7. `DecPacked.cc:59` - move semantics –≤ third-party

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ **–ú–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ TODO** - —Ö–æ—Ä–æ—à–∏–π –∑–Ω–∞–∫
- ‚úÖ **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏** - –Ω–µ abstract TODOs
- ‚ö†Ô∏è **–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ** - –æ—Å–æ–±–µ–Ω–Ω–æ NUMERIC(38,x) handling

### Modern C++ Usage (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**C++20 features –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ:**

```cpp
// Concepts (—á–∞—Å—Ç–∏—á–Ω–æ)
template<typename T>
concept HasToFirebird = requires(T t) {
    { TypeAdapter<T>::to_firebird(t) };
};

// if constexpr (C++17, –Ω–æ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
if constexpr (is_tuple_v<T>) { /* ... */ }

// Fold expressions (C++17)
((pack_field<std::tuple_element_t<Is, Tuple>>(
    std::get<Is>(value), buffer, meta, Is, txn
)), ...);

// std::optional
std::optional<int64_t> nullable_value;

// Smart pointers –≤–µ–∑–¥–µ
std::unique_ptr<Statement> stmt;
std::shared_ptr<Transaction> txn;

// Lambda captures
auto logger = util::Logging::get();
```

**–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è):**
- ‚ö†Ô∏è **Ranges library** (C++20) - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ fetchAll
- ‚ö†Ô∏è **Coroutines** (C++20) - –¥–ª—è async API
- ‚ö†Ô∏è **std::span** (C++20) - –≤–º–µ—Å—Ç–æ raw pointers –¥–ª—è buffers
- ‚ö†Ô∏è **std::format** (C++20) - –≤–º–µ—Å—Ç–æ stream formatting

### Compiler Warnings (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

```cmake
target_compile_options(fbpp PRIVATE -Wno-unused-parameter)
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω suppressed warning - —Ö–æ—Ä–æ—à–æ
- ‚ö†Ô∏è **–ù–µ—Ç -Wall -Wextra -Werror** - –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```cmake
target_compile_options(fbpp PRIVATE
    -Wall
    -Wextra
    -Wpedantic
    -Wno-unused-parameter
    $<$<CXX_COMPILER_ID:GNU>:-Wshadow>
    $<$<CXX_COMPILER_ID:Clang>:-Wno-c++98-compat>
)
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Test Coverage (‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ)

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- 14 test suites
- ~50-70 individual tests (–ø—Ä–∏–º–µ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞)
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞: **–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ** (–Ω–µ—Ç code coverage)

**Test files:**
```
tests/
‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ test_statement.cpp             # Statement execution
‚îÇ   ‚îú‚îÄ‚îÄ test_statement_cache.cpp       # Caching logic
‚îÇ   ‚îú‚îÄ‚îÄ test_cached_statements.cpp     # Integration tests
‚îÇ   ‚îú‚îÄ‚îÄ test_named_parameters.cpp      # Named params
‚îÇ   ‚îú‚îÄ‚îÄ test_cancel_operation.cpp      # Cancel ops
‚îÇ   ‚îú‚îÄ‚îÄ test_core_wrapper.cpp          # Core wrappers
‚îÇ   ‚îú‚îÄ‚îÄ test_firebird_exception.cpp    # Exception handling
‚îÇ   ‚îú‚îÄ‚îÄ test_logging.cpp               # Logging
‚îÇ   ‚îú‚îÄ‚îÄ test_config.cpp                # Configuration
‚îÇ   ‚îî‚îÄ‚îÄ test_fbclient_symbols.cpp      # Library loading
‚îî‚îÄ‚îÄ adapters/
    ‚îú‚îÄ‚îÄ test_ttmath_int128.cpp         # INT128 adapter
    ‚îú‚îÄ‚îÄ test_ttmath_scale.cpp          # NUMERIC(38,x)
    ‚îú‚îÄ‚îÄ test_cppdecimal_decfloat.cpp   # DECFLOAT adapter
    ‚îî‚îÄ‚îÄ test_adapted_type_traits.cpp   # Type traits
```

**–ß—Ç–æ –ø–æ–∫—Ä—ã—Ç–æ:**
- ‚úÖ Basic CRUD operations
- ‚úÖ Extended types (INT128, DECFLOAT, NUMERIC(38,x))
- ‚úÖ Named parameters
- ‚úÖ Statement caching
- ‚úÖ Cancel operations
- ‚úÖ Type adapters

**–ß—Ç–æ –ù–ï –ø–æ–∫—Ä—ã—Ç–æ:**
- ‚ùå Batch operations (minimal coverage)
- ‚ùå BLOB operations
- ‚ùå Connection pooling (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚ùå Thread safety
- ‚ùå Error recovery
- ‚ùå Memory leaks (–Ω–µ—Ç valgrind –≤ CI)
- ‚ùå Performance benchmarks

### Test Quality (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞:**
```cpp
TEST_F(StatementTest, ExecuteInsert) {
    auto stmt = connection_->prepareStatement(
        "INSERT INTO statement_test (id, name, amount) VALUES (1, 'Test', 123.45)"
    );

    auto tra = connection_->StartTransaction();
    unsigned affected = tra->execute(stmt);
    EXPECT_EQ(affected, 1);
    tra->Commit();
}
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GoogleTest framework
- ‚úÖ Test fixtures (TempDatabaseTest base class)
- ‚úÖ –ß–∏—Å—Ç—ã–µ, —á–∏—Ç–∞–µ–º—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ expected behavior

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ—Ç negative tests** - —á—Ç–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å invalid SQL?
- ‚ö†Ô∏è **–ù–µ—Ç edge cases** - max values –¥–ª—è INT128, NUMERIC(38,38)
- ‚ö†Ô∏è **–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** - –¥–ª—è testing multiple scenarios
- ‚ö†Ô∏è **Live Firebird dependency** - —Å–ª–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –±–µ–∑ Firebird server

### Test Infrastructure (‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ)

**TempDatabaseTest base class:**
```cpp
class TempDatabaseTest : public ::testing::Test {
protected:
    void SetUp() override {
        // Create temporary database
        Connection::dropDatabase(db_path_, params_);
        Connection::createDatabase(db_path_, params_);
        connection_ = std::make_unique<Connection>(params_);
    }

    void TearDown() override {
        connection_.reset();
        Connection::dropDatabase(db_path_, params_);
    }

    std::unique_ptr<Connection> connection_;
};
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç = fresh database)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup
- ‚úÖ Configuration-driven (test_config.json)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ú–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** - —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç
- ‚ö†Ô∏è **–ù–µ—Ç mock Firebird API** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ unit testing –±–µ–∑ Firebird

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å MockFirebirdAPI –¥–ª—è unit tests
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å shared test database –¥–ª—è integration tests

### Examples Quality (‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê)

**10 examples:**
```
01_basic_operations.cpp       # CRUD with tuples
02_json_operations.cpp        # JSON binding
03_batch_simple.cpp           # Basic batch
04_batch_advanced.cpp         # Advanced batch
06_named_parameters.cpp       # Named params
07_cancel_operation.cpp       # Cancel long queries
07_cancel_test_variants.cpp  # Cancel variants
```

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ **–ü–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ features**
- ‚úÖ **–•–æ—Ä–æ—à–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã**
- ‚úÖ **–†–∞–±–æ—Ç–∞—é—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î** (–Ω–µ —Å—Ç–∞–±)
- ‚úÖ **–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç best practices**

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è **–ù–µ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å CI** (BUILD_EXAMPLES=OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚ö†Ô∏è **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** (config loading –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏–º–µ—Ä–µ)

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–∏—Å–∫–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (Priority: HIGH)

#### 1. ‚õî –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Connection Pool

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–µ Connection, –Ω–µ—Ç pooling mechanism.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
// –¢–µ–∫—É—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
// "Assumption: one connection is used from one thread"

// –í multi-threaded application:
void handle_request() {
    // –°–æ–∑–¥–∞—Ç—å connection –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ - –î–û–†–û–ì–û!
    Connection conn("database");
    // ...
}
```

**–í–ª–∏—è–Ω–∏–µ:**
- üî¥ –ù–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ –¥–ª—è high-performance server applications
- üî¥ –ë–æ–ª—å—à–æ–π overhead –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ/—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ connections
- üî¥ –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ max connections –∫ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
class ConnectionPool {
public:
    ConnectionPool(const ConnectionParams& params, size_t pool_size);

    // RAII wrapper –¥–ª—è auto-return
    class PooledConnection {
        std::shared_ptr<Connection> conn_;
        ConnectionPool* pool_;
    public:
        ~PooledConnection() { pool_->returnConnection(std::move(conn_)); }
        Connection* operator->() { return conn_.get(); }
    };

    PooledConnection acquire();
    void returnConnection(std::shared_ptr<Connection> conn);

private:
    std::queue<std::shared_ptr<Connection>> available_;
    std::mutex mutex_;
    std::condition_variable cv_;
};
```

#### 2. ‚õî Singleton Environment - Testability Issues

**–û–ø–∏—Å–∞–Ω–∏–µ:** Environment —è–≤–ª—è–µ—Ç—Å—è singleton, –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç testing.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
class Environment {
    static Environment& getInstance() {
        static Environment instance;
        return instance;
    }
};

// –í —Ç–µ—Å—Ç–∞—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ:
// - Mock Firebird interfaces
// - Test —Å —Ä–∞–∑–Ω—ã–º–∏ Firebird versions
// - Isolate tests
```

**–í–ª–∏—è–Ω–∏–µ:**
- üî¥ –°–ª–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å unit tests –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Firebird
- üî¥ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ Firebird instances
- üî¥ –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ: Dependency Injection**
```cpp
class Environment {
public:
    Environment(Firebird::IMaster* master = nullptr);  // nullptr = default
    // ...
};

class Connection {
    Connection(Environment& env, const ConnectionParams& params);
    // ...
private:
    Environment& env_;
};

// –î–ª—è —Ç–µ—Å—Ç–æ–≤:
class MockEnvironment : public Environment {
    MockEnvironment() : Environment(mock_master_) {}
    MockFirebirdMaster mock_master_;
};
```

#### 3. ‚õî –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è BLOB Support

**–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–æ–ª—å–∫–æ loadBlob/createBlob, –Ω–µ—Ç streaming API.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
// –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–ï–°–¨ BLOB –≤ –ø–∞–º—è—Ç—å:
std::vector<uint8_t> Transaction::loadBlob(ISC_QUAD* blobId) {
    // –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –≤ –≤–µ–∫—Ç–æ—Ä - –ø–ª–æ—Ö–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö BLOBs!
}
```

**–í–ª–∏—è–Ω–∏–µ:**
- üî¥ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ BLOBs (> 100MB)
- üî¥ Memory consumption –¥–ª—è –±–æ–ª—å—à–∏—Ö files
- üî¥ –ù–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è long-running operations

**–†–µ—à–µ–Ω–∏–µ: Streaming API**
```cpp
class BlobReader {
public:
    size_t read(uint8_t* buffer, size_t size);
    bool eof() const;
    size_t size() const;
};

class BlobWriter {
public:
    void write(const uint8_t* buffer, size_t size);
    void close();
};

// Usage:
auto reader = txn.openBlobReader(blobId);
while (!reader.eof()) {
    uint8_t buffer[4096];
    size_t bytes_read = reader.read(buffer, sizeof(buffer));
    process(buffer, bytes_read);
}
```

### –°–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (Priority: MEDIUM)

#### 4. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Async API

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ synchronous, –±–ª–æ–∫–∏—Ä—É—é—Ç –ø–æ—Ç–æ–∫.

**–í–ª–∏—è–Ω–∏–µ:**
- üü° –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è async frameworks (Asio, coroutines)
- üü° –û–¥–∏–Ω –º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø–æ—Ç–æ–∫

**–†–µ—à–µ–Ω–∏–µ: C++20 Coroutines**
```cpp
std::future<ResultSet> Statement::executeQueryAsync(Transaction* txn) {
    return std::async(std::launch::async, [this, txn]() {
        return executeQuery(txn);
    });
}

// –ò–ª–∏ —Å coroutines (C++20):
Task<ResultSet> Statement::executeQueryCoro(Transaction* txn) {
    co_await switch_to_background_thread();
    co_return executeQuery(txn);
}
```

#### 5. ‚ö†Ô∏è Raw Pointers –¥–ª—è Connection* –≤ Statement

**–û–ø–∏—Å–∞–Ω–∏–µ:** Statement —Ö—Ä–∞–Ω–∏—Ç `Connection* connection_` –∫–∞–∫ raw pointer.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
class Statement {
    Connection* connection_;  // Non-owning, dangling pointer risk!
};

// –ï—Å–ª–∏ Connection —É–Ω–∏—á—Ç–æ–∂–µ–Ω —Ä–∞–Ω—å—à–µ Statement:
{
    auto conn = std::make_unique<Connection>(params);
    auto stmt = conn->prepareStatement("SELECT ...");
    // conn —É–Ω–∏—á—Ç–æ–∂–µ–Ω
} // stmt —Å–æ–¥–µ—Ä–∂–∏—Ç dangling pointer!
```

**–í–ª–∏—è–Ω–∏–µ:**
- üü° –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π UB –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- üü° –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ –æ—á–µ–Ω—å —á–µ—Ç–∫–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç lifetime requirements

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
class Statement {
    std::weak_ptr<Connection> connection_;  // Weak reference

    Connection* getConnection() const {
        auto conn = connection_.lock();
        if (!conn) throw FirebirdException("Connection destroyed");
        return conn.get();
    }
};
```

#### 6. ‚ö†Ô∏è –ù–µ—Ç Prepared Statement Parameter Metadata

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```cpp
auto stmt = conn.prepareStatement("SELECT * FROM users WHERE id = ?");

// –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å:
// - –°–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤?
// - –ö–∞–∫–∏–µ —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤?
// - –ö–∞–∫–∏–µ –∏–º–µ–Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤? (–¥–ª—è named params)

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ!
```

**–í–ª–∏—è–Ω–∏–µ:**
- üü° –ù–µ—É–¥–æ–±–Ω–æ –¥–ª—è dynamic query building
- üü° –ù–µ—Ç runtime validation

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
class Statement {
    struct ParameterInfo {
        unsigned index;
        std::string name;  // –î–ª—è named parameters
        unsigned type;
        unsigned length;
        int scale;
        bool nullable;
    };

    std::vector<ParameterInfo> getParameters() const;
};
```

### –ú–∏–Ω–æ—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (Priority: LOW)

#### 7. ‚ÑπÔ∏è –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Firebird Arrays

**–í–ª–∏—è–Ω–∏–µ:** üü¢ –†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ production

#### 8. ‚ÑπÔ∏è –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Savepoints

**–í–ª–∏—è–Ω–∏–µ:** üü¢ –ú–æ–∂–Ω–æ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ nested transactions

#### 9. ‚ÑπÔ∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Firebird Events API

**–í–ª–∏—è–Ω–∏–µ:** üü¢ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å polling –∏–ª–∏ external notification

#### 10. ‚ÑπÔ∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Services API

**–í–ª–∏—è–Ω–∏–µ:** üü¢ Backup/restore –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ CLI tools

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 1. –î–æ–±–∞–≤–∏—Ç—å Connection Pool (Priority: üî¥ HIGH)

**–ó–∞—á–µ–º:**
- Thread-safe –¥–æ—Å—Ç—É–ø –∫ –ë–î
- Reuse connections
- Control max connections
- Production-ready

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```cpp
// include/fbpp/core/connection_pool.hpp
namespace fbpp::core {

class ConnectionPool {
public:
    struct Config {
        size_t min_connections = 2;
        size_t max_connections = 10;
        std::chrono::seconds connection_timeout{30};
        std::chrono::seconds idle_timeout{300};
        bool test_on_acquire = true;
    };

    ConnectionPool(const ConnectionParams& params, const Config& config);
    ~ConnectionPool();

    // RAII wrapper
    class PooledConnection {
    public:
        ~PooledConnection();
        Connection* operator->();
        Connection& operator*();

    private:
        friend class ConnectionPool;
        PooledConnection(std::shared_ptr<Connection> conn, ConnectionPool* pool);
        std::shared_ptr<Connection> conn_;
        ConnectionPool* pool_;
    };

    PooledConnection acquire(std::chrono::milliseconds timeout = std::chrono::milliseconds{0});

    struct Statistics {
        size_t total_connections;
        size_t available_connections;
        size_t active_connections;
        size_t total_acquires;
        size_t total_releases;
        size_t timeouts;
    };

    Statistics getStatistics() const;
    void shrink();  // Remove idle connections

private:
    void returnConnection(std::shared_ptr<Connection> conn);
    std::shared_ptr<Connection> createConnection();
    bool testConnection(Connection* conn);

    ConnectionParams params_;
    Config config_;

    std::queue<std::shared_ptr<Connection>> available_;
    std::set<std::shared_ptr<Connection>> active_;

    mutable std::mutex mutex_;
    std::condition_variable cv_;
    Statistics stats_;
};

} // namespace fbpp::core
```

**Usage:**
```cpp
// –°–æ–∑–¥–∞–Ω–∏–µ pool
ConnectionPool pool(params, ConnectionPool::Config{
    .min_connections = 5,
    .max_connections = 20
});

// –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∑–∞–ø—Ä–æ—Å–∞
void handle_request() {
    auto conn = pool.acquire();  // RAII
    auto txn = conn->StartTransaction();
    // ...
    txn->Commit();
}  // Connection –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ pool
```

#### 2. –ó–∞–º–µ–Ω–∏—Ç—å Singleton –Ω–∞ Dependency Injection (Priority: üî¥ HIGH)

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```cpp
// –í–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π singleton
auto& env = Environment::getInstance();
```

**–ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω:**
```cpp
// include/fbpp/core/environment.hpp
class Environment {
public:
    // Factory methods
    static std::shared_ptr<Environment> create();
    static std::shared_ptr<Environment> createWithMaster(Firebird::IMaster* master);

    Environment(const Environment&) = delete;
    Environment& operator=(const Environment&) = delete;

    Firebird::IMaster* getMaster() const;
    Firebird::IProvider* getProvider() const;
    Firebird::IUtil* getUtil() const;

private:
    Environment(Firebird::IMaster* master);

    Firebird::IMaster* master_;
    Firebird::IProvider* provider_;
    Firebird::IUtil* util_;
};

// include/fbpp/core/connection.hpp
class Connection {
public:
    Connection(std::shared_ptr<Environment> env, const ConnectionParams& params);

private:
    std::shared_ptr<Environment> env_;  // Shared ownership
    // ...
};
```

**Migration path:**
```cpp
// –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –æ—Å—Ç–∞–≤–∏—Ç—å:
namespace fbpp::core {
    inline std::shared_ptr<Environment> getDefaultEnvironment() {
        static auto env = Environment::create();
        return env;
    }
}

// –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
Connection conn(params);  // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç getDefaultEnvironment()

// –ù–æ–≤—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç inject:
auto env = Environment::createWithMaster(custom_master);
Connection conn(env, params);
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å Async API —Å Coroutines (Priority: üü° MEDIUM)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```cpp
// include/fbpp/core/async/task.hpp
namespace fbpp::core::async {

template<typename T>
class Task {
public:
    struct promise_type {
        Task get_return_object();
        std::suspend_never initial_suspend();
        std::suspend_never final_suspend() noexcept;
        void unhandled_exception();
        void return_value(T value);

    private:
        std::optional<T> value_;
    };

    bool await_ready();
    void await_suspend(std::coroutine_handle<> h);
    T await_resume();

private:
    std::coroutine_handle<promise_type> coro_;
};

} // namespace fbpp::core::async

// include/fbpp/core/async/statement.hpp
namespace fbpp::core::async {

class AsyncStatement {
public:
    AsyncStatement(std::shared_ptr<Statement> stmt);

    Task<unsigned> execute(Transaction* txn);

    template<typename InParams>
    Task<unsigned> execute(Transaction* txn, const InParams& params);

    Task<std::unique_ptr<ResultSet>> executeQuery(Transaction* txn);

private:
    std::shared_ptr<Statement> stmt_;
    std::shared_ptr<asio::thread_pool> executor_;
};

} // namespace fbpp::core::async
```

**Usage:**
```cpp
#include <fbpp/core/async/statement.hpp>

Task<void> handle_request(Connection& conn) {
    auto txn = conn.StartTransaction();
    auto stmt = conn.prepareStatement("SELECT * FROM users WHERE id = ?");

    // Async execution
    AsyncStatement async_stmt(stmt);
    auto rs = co_await async_stmt.executeQuery(txn, std::make_tuple(123));

    // Fetch results
    while (auto row = co_await rs->fetchOneAsync<int, std::string>()) {
        std::cout << std::get<1>(*row) << std::endl;
    }

    txn->Commit();
}
```

### API Improvements

#### 4. –î–æ–±–∞–≤–∏—Ç—å Builder Pattern –¥–ª—è Connection (Priority: üü° MEDIUM)

**–¢–µ–∫—É—â–∏–π API:**
```cpp
ConnectionParams params;
params.database = "localhost:employee.fdb";
params.user = "SYSDBA";
params.password = "masterkey";
params.charset = "UTF8";
params.role = "admin";

Connection conn(params);
```

**–ù–æ–≤—ã–π fluent API:**
```cpp
auto conn = Connection::builder()
    .database("localhost:employee.fdb")
    .user("SYSDBA")
    .password("masterkey")
    .charset("UTF8")
    .role("admin")
    .timeout(std::chrono::seconds{30})
    .poolSize(10)
    .build();
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```cpp
class ConnectionBuilder {
public:
    ConnectionBuilder& database(const std::string& db);
    ConnectionBuilder& user(const std::string& u);
    ConnectionBuilder& password(const std::string& p);
    ConnectionBuilder& charset(const std::string& cs);
    ConnectionBuilder& role(const std::string& r);
    ConnectionBuilder& timeout(std::chrono::seconds t);
    ConnectionBuilder& poolSize(size_t size);

    std::unique_ptr<Connection> build();
    std::shared_ptr<ConnectionPool> buildPool();

private:
    ConnectionParams params_;
    ConnectionPool::Config pool_config_;
};
```

#### 5. –£–ª—É—á—à–∏—Ç—å BLOB API (Priority: üî¥ HIGH)

**–ù–æ–≤—ã–π Streaming BLOB API:**
```cpp
// include/fbpp/core/blob.hpp
namespace fbpp::core {

class BlobReader {
public:
    size_t read(uint8_t* buffer, size_t size);
    size_t read(std::span<uint8_t> buffer);  // C++20

    bool eof() const;
    size_t size() const;
    size_t tell() const;

    // High-level helpers
    std::vector<uint8_t> readAll();
    std::string readAllAsString();
    void copyToFile(const std::filesystem::path& path);
    void copyToStream(std::ostream& os);
};

class BlobWriter {
public:
    void write(const uint8_t* buffer, size_t size);
    void write(std::span<const uint8_t> buffer);  // C++20
    void write(std::string_view str);

    void close();
    size_t size() const;

    // High-level helpers
    void writeAll(const std::vector<uint8_t>& data);
    void writeString(const std::string& str);
    void copyFromFile(const std::filesystem::path& path);
    void copyFromStream(std::istream& is);
};

class Blob {
public:
    BlobReader openReader(Transaction* txn) const;
    static BlobWriter createWriter(Transaction* txn);

    bool isNull() const;
    size_t size(Transaction* txn) const;
};

} // namespace fbpp::core
```

**Usage:**
```cpp
// Reading BLOB
auto stmt = conn.prepareStatement("SELECT id, photo FROM users WHERE id = ?");
auto rs = stmt.executeQuery(txn, std::make_tuple(123));
if (auto row = rs.fetchOne<int, Blob>()) {
    auto [id, photo_blob] = *row;

    // Stream to file
    auto reader = photo_blob.openReader(txn.get());
    reader.copyToFile("/tmp/photo.jpg");
}

// Writing BLOB
auto stmt = conn.prepareStatement("INSERT INTO users (id, photo) VALUES (?, ?)");
auto writer = Blob::createWriter(txn.get());
writer.copyFromFile("/tmp/new_photo.jpg");
auto blob = writer.finalize();

stmt.execute(txn, std::make_tuple(456, blob));
```

#### 6. –î–æ–±–∞–≤–∏—Ç—å Query Builder (Priority: üü¢ LOW)

**–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è SQL:**
```cpp
// include/fbpp/core/query_builder.hpp
namespace fbpp::core {

class QueryBuilder {
public:
    QueryBuilder& select(const std::vector<std::string>& columns);
    QueryBuilder& from(const std::string& table);
    QueryBuilder& where(const std::string& condition);
    QueryBuilder& orderBy(const std::string& column, bool desc = false);
    QueryBuilder& limit(size_t n);

    std::string build() const;

    // Execute directly
    std::unique_ptr<ResultSet> execute(Connection& conn, Transaction* txn);

    template<typename... Params>
    std::unique_ptr<ResultSet> execute(Connection& conn, Transaction* txn, Params&&... params);
};

} // namespace fbpp::core
```

**Usage:**
```cpp
auto qb = QueryBuilder()
    .select({"id", "name", "salary"})
    .from("employees")
    .where("department = ? AND salary > ?")
    .orderBy("salary", true)
    .limit(10);

auto rs = qb.execute(conn, txn, "IT", 50000);
```

### Type System Improvements

#### 7. –î–æ–±–∞–≤–∏—Ç—å std::span Support (Priority: üü° MEDIUM)

**–ó–∞–º–µ–Ω–∏—Ç—å raw pointers –Ω–∞ std::span:**
```cpp
// –¢–µ–∫—É—â–∏–π API:
void pack(const T& value, uint8_t* buffer, MessageMetadata* meta, Transaction* txn);

// –ù–æ–≤—ã–π API:
void pack(const T& value, std::span<uint8_t> buffer, MessageMetadata* meta, Transaction* txn);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Type safety (bounds checking –≤ debug)
- ‚úÖ Size information included
- ‚úÖ Modern C++20

#### 8. –î–æ–±–∞–≤–∏—Ç—å C++20 Chrono Types (Priority: üü¢ LOW)

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤:**
```cpp
// include/fbpp/adapters/chrono_calendar.hpp
namespace fbpp::adapters {

// DATE ‚Üí std::chrono::year_month_day
template<>
struct TypeAdapter<std::chrono::year_month_day> { /* ... */ };

// TIME ‚Üí std::chrono::hh_mm_ss
template<>
struct TypeAdapter<std::chrono::hh_mm_ss<std::chrono::microseconds>> { /* ... */ };

// TIMESTAMP WITH TIME ZONE ‚Üí std::chrono::zoned_time
template<>
struct TypeAdapter<std::chrono::zoned_time<std::chrono::microseconds>> { /* ... */ };

} // namespace fbpp::adapters
```

#### 9. –£–ª—É—á—à–∏—Ç—å Error Codes (Priority: üü° MEDIUM)

**–î–æ–±–∞–≤–∏—Ç—å typed error codes:**
```cpp
// include/fbpp/core/error_codes.hpp
namespace fbpp::core {

enum class ErrorCode {
    // Connection errors
    ConnectionFailed = 335544721,
    DatabaseNotFound = 335544734,
    NetworkError = 335544726,

    // Transaction errors
    DeadlockDetected = 335544336,
    LockConflict = 335544345,

    // Statement errors
    SyntaxError = 335544634,
    TableNotFound = 335544580,
    ColumnNotFound = 335544578,

    // Type errors
    ConversionError = 335544321,
    NumericOverflow = 335544779,

    // Other
    Unknown = 0
};

class FirebirdException : public std::runtime_error {
public:
    ErrorCode getErrorCode() const;
    bool isRetryable() const;
    bool isConnectionError() const;
    bool isTransactionError() const;

    static ErrorCode fromFirebirdCode(int fb_code);
};

} // namespace fbpp::core
```

### Testing Improvements

#### 10. –î–æ–±–∞–≤–∏—Ç—å Code Coverage (Priority: üî¥ HIGH)

**CMake configuration:**
```cmake
option(ENABLE_COVERAGE "Enable code coverage" OFF)

if(ENABLE_COVERAGE)
    target_compile_options(fbpp PRIVATE --coverage)
    target_link_options(fbpp PRIVATE --coverage)
endif()
```

**CI integration:**
```yaml
- name: Generate coverage
  run: |
    cmake --build build --target coverage
    lcov --capture --directory . --output-file coverage.info
    lcov --remove coverage.info '/usr/*' 'third_party/*' --output-file coverage.info

- name: Upload to Codecov
  uses: codecov/codecov-action@v4
  with:
    file: ./coverage.info
```

**–¶–µ–ª—å:** –î–æ—Å—Ç–∏—á—å 80%+ code coverage

#### 11. –î–æ–±–∞–≤–∏—Ç—å Mock Firebird API (Priority: üî¥ HIGH)

**–î–ª—è unit testing –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Firebird:**
```cpp
// tests/mocks/mock_firebird.hpp
class MockMaster : public Firebird::IMaster {
public:
    MOCK_METHOD(Firebird::IProvider*, getDispatcher, (), (override));
    MOCK_METHOD(Firebird::IUtil*, getUtilInterface, (), (override));
    MOCK_METHOD(Firebird::IStatus*, getStatus, (), (override));
    // ...
};

class MockAttachment : public Firebird::IAttachment {
public:
    MOCK_METHOD(Firebird::ITransaction*, startTransaction,
                (Firebird::IStatus*, unsigned, const unsigned char*), (override));
    MOCK_METHOD(Firebird::IStatement*, prepare,
                (Firebird::IStatus*, Firebird::ITransaction*, unsigned,
                 const char*, unsigned, unsigned), (override));
    // ...
};
```

**Usage in tests:**
```cpp
TEST(ConnectionTest, StartTransaction) {
    MockMaster mock_master;
    MockAttachment mock_attachment;

    EXPECT_CALL(mock_attachment, startTransaction(_, _, _))
        .WillOnce(Return(&mock_transaction));

    auto env = Environment::createWithMaster(&mock_master);
    Connection conn(env, params);
    auto txn = conn.StartTransaction();

    EXPECT_NE(txn, nullptr);
}
```

#### 12. –î–æ–±–∞–≤–∏—Ç—å Performance Benchmarks (Priority: üü° MEDIUM)

**Google Benchmark integration:**
```cpp
// benchmarks/bench_statement_cache.cpp
#include <benchmark/benchmark.h>
#include <fbpp/fbpp.hpp>

static void BM_PrepareWithCache(benchmark::State& state) {
    Connection conn(params);

    for (auto _ : state) {
        auto stmt = conn.prepareStatement("SELECT 1 FROM RDB$DATABASE");
        benchmark::DoNotOptimize(stmt);
    }
}
BENCHMARK(BM_PrepareWithCache);

static void BM_PrepareWithoutCache(benchmark::State& state) {
    Connection conn(params);
    conn.clearStatementCache();

    for (auto _ : state) {
        auto stmt = conn.prepareStatement("SELECT 1 FROM RDB$DATABASE");
        benchmark::DoNotOptimize(stmt);
    }
}
BENCHMARK(BM_PrepareWithoutCache);

BENCHMARK_MAIN();
```

**–¶–µ–ª—å:**
- –ò–∑–º–µ—Ä–∏—Ç—å overhead statement cache
- –°—Ä–∞–≤–Ω–∏—Ç—å JSON vs Tuple performance
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞—Ç—å extended types conversions

### Documentation Improvements

#### 13. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Doxygen Docs (Priority: üü° MEDIUM)

**Doxyfile:**
```
PROJECT_NAME = "fbpp - Firebird C++20 Wrapper"
INPUT = include/fbpp README.md
RECURSIVE = YES
GENERATE_HTML = YES
GENERATE_LATEX = NO
EXTRACT_ALL = YES
USE_MDFILE_AS_MAINPAGE = README.md
```

**CMake:**
```cmake
find_package(Doxygen)
if(DOXYGEN_FOUND)
    add_custom_target(docs
        COMMAND ${DOXYGEN_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/Doxyfile
        WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
        COMMENT "Generating API documentation with Doxygen"
    )
endif()
```

**GitHub Pages deployment:**
```yaml
- name: Build docs
  run: cmake --build build --target docs

- name: Deploy to GitHub Pages
  uses: peaceiris/actions-gh-pages@v3
  with:
    github_token: ${{ secrets.GITHUB_TOKEN }}
    publish_dir: ./build/docs/html
```

#### 14. –£–ª—É—á—à–∏—Ç—å README.md (Priority: üî¥ HIGH)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** 1 —Å—Ç—Ä–æ–∫–∞!

**–î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
```markdown
# fbpp - Modern C++20 Firebird Wrapper

[![CI](badge)](link)
[![Coverage](badge)](link)
[![License](badge)](link)

Modern, type-safe C++20 wrapper for Firebird 5 database.

## Features
- Full support for Firebird 5 extended types
- JSON and tuple-based data binding
- Statement caching for performance
- Named parameters
- RAII resource management

## Quick Start
\`\`\`cpp
auto conn = Connection::builder()
    .database("localhost:employee.fdb")
    .user("SYSDBA")
    .password("masterkey")
    .build();

auto txn = conn->StartTransaction();
auto stmt = conn->prepareStatement("SELECT * FROM employee WHERE emp_no = ?");
auto rs = stmt->executeQuery(txn, std::make_tuple(42));

while (auto row = rs->fetchOne<int, std::string, double>()) {
    auto [emp_no, name, salary] = *row;
    std::cout << name << ": " << salary << std::endl;
}

txn->Commit();
\`\`\`

## Installation
### Conan
\`\`\`bash
conan install --requires=fbpp/1.0.0
\`\`\`

### CMake
\`\`\`bash
git clone https://github.com/sashok74/fbpp.git
cd fbpp
./build.sh Release
sudo cmake --install build
\`\`\`

## Documentation
- [API Documentation](https://sashok74.github.io/fbpp/)
- [User Guide](docs/USER_GUIDE.md)
- [Examples](examples/)

## Requirements
- C++20 compiler (GCC 11+, Clang 14+, MSVC 2022+)
- Firebird 5.x client library
- CMake 3.20+

## License
MIT License - see LICENSE file
```

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è

### Feature Wishlist (–ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º)

#### Tier 1: Must Have (–¥–ª—è production-ready)

1. **Connection Pool** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   - Essential –¥–ª—è multi-threaded applications
   - Estimated effort: 3-5 days

2. **Improved BLOB Support** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   - Streaming API –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
   - Estimated effort: 2-3 days

3. **Mock Firebird API** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   - –î–ª—è unit testing –±–µ–∑ –ë–î
   - Estimated effort: 5-7 days

4. **Code Coverage** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   - –ò–∑–º–µ—Ä–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤
   - Estimated effort: 1 day

5. **Proper README.md** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
   - First impression matters!
   - Estimated effort: 2 hours

#### Tier 2: Should Have (–¥–ª—è better UX)

6. **Async API with Coroutines** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
   - Modern async programming
   - Estimated effort: 5-7 days

7. **Connection Builder** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
   - Fluent API –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
   - Estimated effort: 1 day

8. **Error Code Enum** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
   - Type-safe error handling
   - Estimated effort: 2 days

9. **Performance Benchmarks** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
   - Regression detection
   - Estimated effort: 2-3 days

10. **Doxygen Documentation** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ
    - Professional API docs
    - Estimated effort: 3 days

#### Tier 3: Nice to Have (–¥–ª—è feature completeness)

11. **Firebird Events API** ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ
    - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    - Estimated effort: 3-4 days

12. **Services API** ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ
    - Backup/restore, user management
    - Estimated effort: 5-7 days

13. **Array Support** ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ
    - Firebird ARRAY type
    - Estimated effort: 2-3 days

14. **Query Builder** ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ
    - Type-safe SQL building
    - Estimated effort: 5-7 days

15. **ORM Layer** ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ
    - Active Record pattern
    - Estimated effort: 14-21 days

### Innovative Ideas

#### 1. Compile-Time SQL Validation

**Concept:** –ü—Ä–æ–≤–µ—Ä–∫–∞ SQL syntax –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

```cpp
// –ò—Å–ø–æ–ª—å–∑—É—è external constexpr –∏–ª–∏ C++23 consteval
constexpr auto query = validate_sql("SELECT * FROM users WHERE id = ?");

// Compile error –µ—Å–ª–∏ SQL –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π!
constexpr auto bad_query = validate_sql("SELEKT * FROM users");  // ‚ùå Compile error
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- Embedded SQL parser (compile-time)
- Schema file —Å metadata
- CMake integration –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ headers

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û—à–∏–±–∫–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –Ω–µ runtime
- Better IDE support (autocomplete)

#### 2. Automatic Migration System

**Concept:** Database schema versioning –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

```cpp
// migrations/001_initial.sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100),
    created TIMESTAMP
);

// migrations/002_add_email.sql
ALTER TABLE users ADD COLUMN email VARCHAR(255);

// C++ code
MigrationManager mgr(conn);
mgr.migrate();  // Apply all pending migrations
```

**Features:**
- Version tracking table
- Up/down migrations
- Transaction safety
- Rollback support

#### 3. Schema Introspection & Code Generation

**Concept:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è C++ structs –∏–∑ database schema

```bash
# Generate C++ types from database
$ fbpp-codegen --database=employee.fdb --output=generated/

# Generated code:
struct Employee {
    int emp_no;
    std::string first_name;
    std::string last_name;
    std::chrono::system_clock::time_point hire_date;
    double salary;

    static constexpr auto table_name = "EMPLOYEE";
    static constexpr auto columns = std::make_tuple("EMP_NO", "FIRST_NAME", ...);
};

// Usage:
auto employees = conn.selectAll<Employee>(txn);
```

**Implementation:**
- CLI tool using Firebird metadata
- Template-based code generation
- CMake integration

#### 4. Query Result Caching

**Concept:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤

```cpp
auto stmt = conn.prepareStatement("SELECT * FROM config WHERE key = ?");

// Enable result caching
stmt.enableResultCache(std::chrono::minutes{5});

// First call - executes query
auto rs1 = stmt.executeQuery(txn, std::make_tuple("max_users"));

// Second call within 5 minutes - returns cached result
auto rs2 = stmt.executeQuery(txn, std::make_tuple("max_users"));  // Cache hit!
```

**Features:**
- Time-based expiration
- Size-based eviction (LRU)
- Cache invalidation on table updates
- Statistics (hit rate, etc.)

#### 5. Distributed Transactions (XA)

**Concept:** Two-phase commit –¥–ª—è distributed transactions

```cpp
XATransactionManager xa_mgr;

auto txn1 = conn1.StartXATransaction(xa_mgr);
auto txn2 = conn2.StartXATransaction(xa_mgr);

// Modify both databases
conn1.execute(txn1, "INSERT INTO orders ...");
conn2.execute(txn2, "UPDATE inventory ...");

// Atomic commit across both databases
xa_mgr.commit();  // Both or neither
```

#### 6. Change Data Capture (CDC)

**Concept:** Track changes –≤ database –¥–ª—è event sourcing

```cpp
CDCStream cdc(conn, "users");

cdc.onInsert([](const json& record) {
    std::cout << "New user: " << record["name"] << std::endl;
});

cdc.onUpdate([](const json& old_record, const json& new_record) {
    std::cout << "Updated: " << old_record["name"]
              << " -> " << new_record["name"] << std::endl;
});

cdc.start();  // Begin monitoring
```

**Implementation:**
- Firebird triggers + events
- Change log table
- Event polling or push

---

## –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –§–∞–∑–∞ 1: Stabilization (2-3 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ–µ–∫—Ç production-ready

1. **–ù–∞–ø–∏—Å–∞—Ç—å README.md** (2 —á–∞—Å–∞)
   - Quick start
   - Features
   - Installation instructions

2. **–î–æ–±–∞–≤–∏—Ç—å .clang-format** (1 —á–∞—Å)
   - –ê–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ –≤—Å–µ–º —Ñ–∞–π–ª–∞–º

3. **Fix –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ TODOs** (1-2 –¥–Ω—è)
   - NUMERIC(38,x) scale handling
   - Overflow checking –≤ TTNumeric

4. **–î–æ–±–∞–≤–∏—Ç—å Connection Pool** (3-5 –¥–Ω–µ–π)
   - Thread-safe pooling
   - Configuration options
   - Statistics

5. **–£–ª—É—á—à–∏—Ç—å BLOB API** (2-3 –¥–Ω—è)
   - Streaming reader/writer
   - File operations
   - Progress callbacks

### –§–∞–∑–∞ 2: Testing & Quality (2-3 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –ü–æ–≤—ã—Å–∏—Ç—å code coverage –∏ –∫–∞—á–µ—Å—Ç–≤–æ

6. **–î–æ–±–∞–≤–∏—Ç—å Mock Firebird API** (5-7 –¥–Ω–µ–π)
   - GMock-based mocks
   - Refactor –¥–ª—è DI

7. **Code Coverage 80%+** (3-5 –¥–Ω–µ–π)
   - Add missing unit tests
   - Integration tests
   - Edge cases

8. **Performance Benchmarks** (2-3 –¥–Ω—è)
   - Google Benchmark setup
   - Critical paths profiling
   - Regression tracking

9. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤** (1-2 –¥–Ω—è)
   - GCC 11, 12, 13
   - Clang 14, 15, 16
   - MSVC 2022

### –§–∞–∑–∞ 3: Features & UX (3-4 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –£–ª—É—á—à–∏—Ç—å developer experience

10. **Async API** (5-7 –¥–Ω–µ–π)
    - C++20 coroutines
    - ASIO integration
    - Examples

11. **Connection Builder** (1 –¥–µ–Ω—å)
    - Fluent API
    - Migration guide

12. **Error Code Enum** (2 –¥–Ω—è)
    - Common Firebird errors
    - Retry logic
    - Better error messages

13. **Doxygen Docs** (3 –¥–Ω—è)
    - Setup Doxyfile
    - Comment –≤—Å–µ public API
    - GitHub Pages deployment

### –§–∞–∑–∞ 4: Advanced Features (4-6 –Ω–µ–¥–µ–ª—å)

**–¶–µ–ª—å:** Feature completeness

14. **Firebird Events API** (3-4 –¥–Ω—è)
    - Callback-based
    - Async support

15. **Services API** (5-7 –¥–Ω–µ–π)
    - Backup/restore
    - User management
    - Statistics

16. **Schema Introspection** (5-7 –¥–Ω–µ–π)
    - Metadata queries
    - Code generation tool
    - CMake integration

17. **Migration System** (7-10 –¥–Ω–µ–π)
    - Version tracking
    - Up/down migrations
    - CLI tool

### –§–∞–∑–∞ 5: Innovation (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 6+ –Ω–µ–¥–µ–ª—å)

18. **Compile-Time SQL Validation**
19. **Query Result Caching**
20. **ORM Layer**

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4/5)

**fbpp** - —ç—Ç–æ **high-quality, well-architected library** —Å –æ—Ç–ª–∏—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ Firebird 5. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∫ C++20, —Ç–∞–∫ –∏ Firebird OO API.

### –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

‚úÖ **–û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - layered, extensible, RAII everywhere
‚úÖ **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ extended types** - INT128, DECFLOAT, NUMERIC(38,x), TIMESTAMP WITH TZ
‚úÖ **Modern C++20** - templates, SFINAE, fold expressions
‚úÖ **Multiple data formats** - JSON, tuples, strongly-typed
‚úÖ **Good documentation** - CLAUDE.md, specialized docs

### –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

‚ö†Ô∏è **–ù–µ—Ç connection pool** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production
‚ö†Ô∏è **Singleton Environment** - –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç testing
‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è BLOB support** - –Ω–µ—Ç streaming API
‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ async API** - –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è async frameworks
‚ö†Ô∏è **Low test coverage** - –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (High Priority):**
1. –ù–∞–ø–∏—Å–∞—Ç—å README.md
2. –î–æ–±–∞–≤–∏—Ç—å Connection Pool
3. –£–ª—É—á—à–∏—Ç—å BLOB API
4. Mock Firebird –¥–ª—è unit tests
5. Code coverage 80%+

**–í—Å–∫–æ—Ä–µ (Medium Priority):**
6. Async API —Å coroutines
7. Connection Builder (fluent API)
8. Error Code enum
9. Performance benchmarks
10. Doxygen documentation

**–í –±—É–¥—É—â–µ–º (Low Priority):**
11. Firebird Events API
12. Services API
13. Query Builder
14. Migration system
15. ORM layer

### –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Ä–¥–∏–∫—Ç

–ü—Ä–æ–µ–∫—Ç **–≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é** –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∏ —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–æ **—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏** –¥–ª—è high-performance production environments.

–° –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º Connection Pool –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π BLOB support, –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–Ω–µ—Ç **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π, production-ready –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Firebird –∏–∑ C++20.

**Recommended next steps:**
1. Implement Connection Pool (üî¥ HIGH)
2. Write comprehensive README.md (üî¥ HIGH)
3. Add Mock Firebird API (üî¥ HIGH)
4. Improve BLOB support (üî¥ HIGH)
5. Achieve 80%+ code coverage (üî¥ HIGH)

**Estimated time to production-ready:** 6-8 weeks (with dedicated effort)

---

**–ö–æ–Ω–µ—Ü –∞–Ω–∞–ª–∏–∑–∞**

–ê–≤—Ç–æ—Ä: Claude Code
–î–∞—Ç–∞: 2025-10-01
–í–µ—Ä—Å–∏—è: 1.0
